/*----------------- REXX ---------- PERGEN --------------*/
R1='';S1='';R2='';S2='';R3='';S3='';R4='';S4='';R5='';S5=''
R6='';S6='';R7='';S7='';R8='';S8='';R9='';S9='';R0='';S0=''
A=0 ; B=0 ; C=0 ; D=0 ; E=0 ; F=0 ; G=0 ; H=0 ; I=0 ; J=0
K=0 ; L=0 ; M=0 ; N=0 ; O=0 ; P=0 ; Q=0 ; R=0 ; S=0 ; T=0
RESUL='' ; RANT=0
VALORES='ABCDEFGHIJKLMNOPQRST0123456789 +-*/%().,'
ADDRESS ISPEXEC
CASIOW:
NUMERIC DIGITS 20
SIGNAL ON SYNTAX
DO FOREVER
   'ADDPOP'
   'DISPLAY PANEL(PCASIO)'
   IF RC=8 THEN EXIT
   PUSH RISTRA
   PULL RISTRA .
   D1=SUBSTR(RISTRA,1,1)
   D2=VERIFY(D1,'ABCDEFGHIJKLMNOPQRST')
   IF D2>0 THEN IF ¬DATATYPE(D1,'N') & D1¬='(' THEN RISTRA2=RANT||RISTRA
                ELSE RISTRA2=RISTRA
   ELSE RISTRA2=RISTRA
   IF VERIFY(RISTRA2,VALORES)¬=0 THEN SIGNAL SYNTAX
   IF INDEX(RISTRA2,',')¬=0 THEN SIGNAL COMAPUNTO
   ELSE DO
      INTERPRET 'RESUL='RISTRA2
      CALL CAMBIO
   END
END
EXIT

SYNTAX:
  ERR='THE ENTER VALUE 'RISTRA' IS NOT CORRECT'
  'SETMSG MSG(CASI010)'
SIGNAL CASIOW

COMAPUNTO:
  ERR='DEBE UTILIZAR ''.'' PARA LOS DECIMALES EN VEZ DE '','' '
  /* THIS IS FOR SPANISH NUMBERS */
  'SETMSG MSG(CASI010)'
SIGNAL CASIOW

CAMBIO:
  S0=S9;S9=S8;S8=S7;S7=S6;S6=S5;S5=S4;S4=S3;S3=S2;S2=S1;S1=R9
  R0=R9;R9=R8;R8=R7;R7=R6;R6=R5;R5=R4;R4=R3;R3=R2;R2=R1;R1=RESUL
  A=R1;B=R2;C=R3;D=R4;E=R5;F=R6;G=R7;H=R8;I=R9;J=R0
  K=S1;L=S2;M=S3;N=S4;O=S5;P=S6;Q=S7;R=S8;S=S9;T=S0
  IF A='' THEN A=0 ; IF B='' THEN B=0 ; IF C='' THEN C=0
  IF D='' THEN D=0 ; IF E='' THEN E=0 ; IF F='' THEN F=0
  IF G='' THEN G=0 ; IF H='' THEN H=0 ; IF I='' THEN I=0
  IF J='' THEN J=0 ; IF K='' THEN K=0 ; IF L='' THEN L=0
  IF M='' THEN M=0 ; IF N='' THEN N=0 ; IF O='' THEN O=0
  IF P='' THEN P=0 ; IF Q='' THEN Q=0 ; IF R='' THEN R=0
  IF S='' THEN S=0 ; IF T='' THEN T=0
  RANT=RESUL
RETURN
