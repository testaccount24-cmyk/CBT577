/*REXX*/
ARG FICH,MIEMB .

IF MIEMB>0 THEN DO
   SAY 'GENERACION NO EXISTENTE, Â¿ QUIERE VER LA ULTIMA ? (S/N)'
   PULL AW
   IF TRANSLATE(AW)='S' THEN GEN=1 ; ELSE RETURN 8
END
ELSE GEN=ABS(MIEMB)+1

DROP GEN.
X=OUTTRAP(GEN.)
"LISTC ENTRIES("FICH") NAME"
ADDRESS ISPEXEC
DO I=GEN.0 TO 1 BY -1
   PUSH GEN.I
   PULL P1 . FF .
   IF P1='NONVSAM' THEN DO
      GEN=GEN-1
      IF GEN=0 THEN DO
         IF INDEX(FF,FICH'.G') THEN DO
            FICH=FF ; 'VPUT (FICH)' ; RETURN 0
         END
      END
   END
END
RETURN 12
