/*REXX*/
PARSE ARG FICHE .
IF FICHE='' THEN FICHE='FICHE'
PARSE SOURCE ENT .
IF ENT¬='TSO' THEN SIGNAL BATCH
IF FICHE='FICHE' THEN DO
     ADDRESS ISREDIT;
     "MACRO"
     "(LIN,COL) = CURSOR"
     "(LINEA) = LINE .ZCSR"
     LINEA=SUBSTR(LINEA,COL)
     X=FFF(LINEA)
     ADDRESS ISPEXEC
     'VGET (FICH,MIEMB)'
   IF MIEMB¬='' & DATATYPE(MIEMB,'N') THEN DO
      X=FGF(FICH,MIEMB)
      IF X=8 THEN EXIT 0
      IF X=12 THEN DO
         ADDRESS ISREDIT
         'LINE_AFTER 'LIN' = MSGLINE "NO EXISTE 'FICH"("MIEMB")"'"'
         EXIT 4
      END
      ADDRESS ISPEXEC  'VGET (FICH)' ; MIEMB=''
   END
   IF MIEMB¬='' THEN FICH="'"FICH'('STRIP(MIEMB)')'"'"
   ELSE FICH="'"FICH"'"
END
ELSE FICH=FICHE
ADDRESS TSO
MSG=MSG('OFF')
'FREE FI(ENTRADA)'
MSG=MSG('ON')
'ALLOC DA('FICH') FI(ENTRADA) SHR REUSE'
IF RC>4 THEN DO
   SAY 'ERROR EN LA ALOCACION DE 'FICH
   EXIT
END
BATCH:
"CALL 'SISSHR.SIST19.LOAD(IRXNREG)' "      /* CHANGE TO YOUR LIBRARY */
IF RC¬=0 THEN EXIT
IF ENT='TSO' THEN 'FREE FI(ENTRADA)'
IF ENT¬='TSO' | (ENT='TSO' & FICHE¬='FICHE') THEN DO
    SAY FICH
    SAY '   NUMERO DE REGISTROS: 'NREGS
/*  SAY '________________________________________________________' */
    EXIT 0
END
ADDRESS ISREDIT;
"(LINEA) = CURSOR"
"LINE_AFTER "LIN" = MSGLINE 'NUMERO DE REGISTROS: "NREGS"'"
"LINE_AFTER "LIN" = MSGLINE '"FICH"'"
IF MIEMB¬=FICH&MIEMB¬='' THEN DO
"LINE_AFTER "LIN" = MSGLINE '--------------------------------------'"
"LINE_AFTER "LIN" = MSGLINE 'LONGITUD: "LENGTH(MIEMB)"'"
"LINE_AFTER "LIN" = MSGLINE '"MIEMB"'"
END
EXIT
